---
title: "Rare disease - onset and networks of significance"
description: |
 A case study of microscopic analysis using our multiple networks framework
author:
  - name: Pisanu Ize Buphamalai
    affiliation: CeMM
    affiliation_url: www.cemm.at 
date: "January 2021"
output: html
---



```{r load the data}
library(ggpubr) # for plots with p values

source("../functions/readdata_functions.R")
source("../functions/process_LCC_result.R")

library(igraph)


# onset data
#######

# load individual gene disease association
orphaID_to_name_df <- read_csv("../data/orphanumbers_to_name.csv", col_names = c("orphaID", "orphaName"))
orphaID_to_name_df$orphaID <- paste0("Orphanet:", orphaID_to_name_df$orphaID)

disease_gene_root_df <- read_tsv("../data/orphaNet_disease_gene_association_with_roots.tsv", col_types = "ccc--c")


# load onset to disease label 
onsets <- list.files("../data/orphanet_onset/")
onset_df <- lapply(onsets, function(x) read_lines(sprintf("../data/orphanet_onset/%s", x))); names(onset_df) <- onsets
onset_df <- melt(onset_df); names(onset_df) <- c("label", "onset")


# join the two tables above
disease_gene_root_onset_df <- left_join(disease_gene_root_df, onset_df)

# make unique rows for each roots and each gene
disease_gene_root_onset_df <- disease_gene_root_onset_df %>% separate_rows(roots, sep = ";") %>% separate_rows(genes, sep = ";")

orpha_to_gene_df = melt(orphaGeneDiseaseList)
colnames(orpha_to_gene_df) = c("gene", "orphaID")


#########
# all orphanet gene associations
orphagroup_gene_df  = process_disease_genes_data("../Disease_gene_assoc/Orphanet/output/table_disease_gene_assoc_orphanet.tsv", 1, 2000)

all_orpha_genes = unique(unlist(orphagroup_gene_df$disgene_list))

# number of disease groups for each gene
gene_orphagroup_df = melt(orphagroup_gene_df$disgene_list); colnames(gene_orphagroup_df) = c("gene",'orphagroup')
gene_orphagroup_df = gene_orphagroup_df %>% 
  dplyr::filter(!is.na(gene)) %>% group_by(gene) %>% 
  summarise(orphagroups = list(orphagroup), n_group = n()) 
  
##########

# load graph
g = process_graph_data("../data/network_edgelists/")

#### load the coexpression network combn and extract core transcriptional module
coex_count_el = readRDS("../cache/coexpression_raw_edge_counts.RDS")

## core transcriptional modules: the number of tissues are over five
g[["coex_coremodule"]] = graph_from_data_frame(coex_count_el[coex_count_el$n >= 5,c("A","B")], directed = F)

# # Com
# deg_df = tibble()
# 
# for(i in names(g)){
#   g_current = g[[i]]
#   # compute degree for genes with onsets
#   nodes = intersect(V(g_current)$name, levels(onset_genelist$gene))
#   deg = degree(g_current, v = nodes)
#   deg_current = data.frame(deg) %>% rownames_to_column(var = "gene") %>% mutate(network = i)
#   deg_df = rbind(deg_df, deg_current)
# }
```


# Difference between genes associated with very early onset and late onsets

Very early = antenatal + prenatal + infancy
Late = adulthood + elderly

```{r boxplot_non_coex}
# annotate the onset to gene-degree df
deg_df_annotate = inner_join(deg_df, onset_genelist)

# onset of interest (to be plotted)
onset_of_interest = c("Late_pure",  "VeryEarly_pure")

p = ggplot(deg_df_annotate %>% dplyr::filter(!grepl("coex", network) & onset %in% onset_of_interest),
           aes(x = onset, y = deg)) + 
    geom_boxplot() + facet_wrap(. ~ network) #+ stat_compare_means(comparisons = my_comparisons, method = "wilcox", label = "p.signif") + scale_y_log10() 

# make comparison on plot, willcoxon pairwise combination of all onset
my_comparisons = combn(onset_of_interest, 2, simplify = F) 
p  + stat_compare_means(comparisons = my_comparisons, method = "wilcox") + scale_y_log10() 
```

```{r boxplot_tissue_coex}

p = ggplot(deg_df_annotate %>% dplyr::filter(grepl("coex", network) & onset %in% onset_of_interest),
           aes(x = onset, y = deg)) + 
  geom_boxplot() + facet_wrap(. ~ network) #+ stat_compare_means(comparisons = my_comparisons, method = "wilcox", label = "p.signif") + scale_y_log10() 

# make comparison on plot, willcoxon pairwise combination of all onset
my_comparisons = combn(onset_of_interest, 2, simplify = F) 
p  + stat_compare_means(comparisons = my_comparisons, method = "wilcox", label = "p.signif") + scale_y_log10() 
```

In summary, by separating gene sets to be very early and late does not help with distinguishing properties of essential genes.


# Analysis of the core transcriptional modules

As defined in the manuscript, the core transcriptional module is the network consisting of edges that appear in at least five different tissues.


```{r}
#### load the coexpression network combn
coex_count_el = readRDS("./cache/coexpression_raw_edge_counts.RDS")

cutoff = c(0, 5, 10, 20, 30)

# core transcriptional module at different cutoffs
g_core_module = list()

for(i in cutoff){
  print(i)
  g_core_module[[as.character(i)]] = graph_from_data_frame(coex_count_el[coex_count_el$n >= i,c("A","B")], directed = F)
}


### perform the same analysis as above

deg_df_core_module = tibble()

for(i in names(g_core_module)){
  g_current = g_core_module[[i]]
  # compute degree for genes with onsets
  nodes = intersect(V(g_current)$name, levels(onset_genelist$gene))
  deg = degree(g_current, v = nodes)
  deg_current = data.frame(deg) %>% rownames_to_column(var = "gene") %>% mutate(network = i)
  deg_df_core_module = rbind(deg_df_core_module, deg_current)
}
###################3

# annotate the onset to gene-degree df
deg_df_annotate_core_module = inner_join(deg_df_core_module, onset_genelist)

# onset of interest (to be plotted)
onset_of_interest = c("Late_pure", "VeryEarly_pure")

```


```{r}
# Core modules (present in at least 5 tissues)
core_module = deg_df_annotate_core_module %>% dplyr::filter(onset %in% onset_of_interest, network == "5")

# how many essential genes are neighbours of these genes
essential_genes = read_tsv("../analysis/network_characterisation/essentiality/OGEE_esential_genes_20190416.txt")
essential_genes$geneSymbol = IDconvert(essential_genes$locus, from = "ENSEMBL", to = "SYMBOL")
essential_genes_sym = essential_genes %>% filter(essential == "E") %>% pull(geneSymbol) %>% unique()

core_module$essential_neighbour = sapply(core_module$gene, function(gene) 
  sum(neighbors(graph = g_core_module$`5`, v = gene)$name %in% essential_genes_sym))

essential_genes_in_graph = sum(V(g_core_module$`5`)$name %in% essential_genes_sym)

# whether the gene is an essential gene
core_module = core_module %>%
  mutate(essential = gene %in% essential_genes_sym,
         essential_pval= phyper(essential_neighbour-1, essential_genes_in_graph, vcount(g_core_module$`5`)-essential_genes_in_graph, deg,lower.tail= FALSE),
         essential_pval_level = cut(essential_pval, breaks = c(1, 0.05,0.01, 0.001,0.0001, 0), labels = rev(c("ns", "*", "**", "***", "****")) ,include.lowest = T),
         essential_pval_signif = ifelse(essential_pval < 0.05, "significant", "not significant"))



# core modules essential genes
ggplot(core_module %>% mutate(essential = factor(essential, levels = c(T,F), labels = c("essential disease genes", "non-essential disease genes"))),
       aes(x = onset, y = deg)) + scale_y_log10() + ylab("network degree") +
  geom_boxplot()  + facet_wrap(. ~ essential)+ stat_compare_means(comparisons = my_comparisons, method = "wilcox") + ggtitle("Essentiality and onset")

# 
# 
# ggplot(core_module %>%
#          group_by(onset, essential_pval_signif, essential) %>% 
#        summarise(count=n()) %>% 
#          mutate(perc=count/sum(count))) + 
#   geom_col(aes(x = essential_pval_signif, y = perc)) + facet_wrap(essential~ onset)
```


## analysis of genes by their earliest onsets

- compute degrees for all the genes
- neighbours that are essential genes
- neighbours that are other disease genes

```{r}
gene_by_earliest_onset_df = readRDS("../cache/gene_by_earliest_onset_orphanet.RDS")


# compute the degree of genes to essential genes
subset_degree_compute = function(graph, gene_set){
  # graph: graph to compute
  # gene_set: gene set to compute neighbours
  adj = as_adj(graph)
  gene_set_position = as.integer(rownames(adj) %in% gene_set)
  # compute the degree of a node that overlaps with a gene set of interest
  degree_geneset =  apply(adj, 2, function(i) sum(i*gene_set_position))
  degree_deneset_df = enframe(degree_geneset, name = "gene", value =  "degree")
  return(degree_geneset)
}

# compute the degree of all genes in all networks
degree_df = lapply(g, function(x) enframe(degree(x), name = "gene", value =  "degree"))
degree_df = bind_rows(degree_df, .id ="network")

# compute degree with essential genes
degree_essential_df = lapply(g, function(x) enframe(subset_degree_compute(x, essential_genes_sym), name = "gene", value =  "degree_essential"))
degree_essential_df = bind_rows(degree_essential_df, .id ="network")

# compute degree with other disease genes
degree_orpha_df = lapply(g, function(x) enframe(subset_degree_compute(x, all_orpha_genes), name = "gene", value =  "degree_orpha"))
degree_orpha_df = bind_rows(degree_orpha_df, .id ="network")

# bind the degree data frames
# join degree properties
gene_network_prop_df = left_join(degree_df, degree_essential_df, by = c("gene","network"))
gene_network_prop_df = left_join(gene_network_prop_df, degree_orpha_df, by = c("gene","network"))

# add number of disease groups it causes
gene_network_prop_df = left_join(gene_network_prop_df, gene_orphagroup_df %>% select(gene, n_group), by = "gene")

# add the earliest onset of the gene
gene_network_prop_df = left_join(gene_network_prop_df, gene_by_earliest_onset_df, by = "gene")

# compute the number of essential and disease gene in each graph
essential_genes_in_graph = sapply(g, function(x) sum(V(x)$name %in% essential_genes_sym))
orpha_genes_in_graph = sapply(g, function(x) sum(V(x)$name %in% all_orpha_genes))
genes_in_graph = sapply(g, vcount)

# add whether the gene is an orphanet gene, an essential gene, and compute hypergeometric probability
gene_network_prop_df = gene_network_prop_df %>%
  mutate(essential = gene %in% essential_genes_sym,
         orphagene = gene %in% all_orpha_genes,
         essential_pval = phyper(degree_essential-1, essential_genes_in_graph[network], genes_in_graph[network] - essential_genes_in_graph[network], degree,lower.tail= FALSE),
         orpha_pval = phyper(degree_orpha-1, orpha_genes_in_graph[network], genes_in_graph[network] - orpha_genes_in_graph[network], degree,lower.tail= FALSE))

# add multiple comparison (per network) and p-value levels
gene_network_prop_df = gene_network_prop_df %>%
  group_by(network) %>%
  mutate(essential_qval = p.adjust(essential_pval, method = "BH"),
         orpha_qval = p.adjust(orpha_pval, method = "BH"),
         essential_qval_level = cut(essential_qval, breaks = c(1, 0.05,0.01, 0.001,0.0001, 0), labels = rev(c("ns", "*", "**", "***", "****"))),
         orpha_qval_level = cut(orpha_qval, breaks = c(1, 0.05,0.01, 0.001,0.0001, 0), labels = rev(c("ns", "*", "**", "***", "****"))),
         essential_qval_signif = ifelse(essential_qval < 0.05, "significant", "not significant"),
         orpha_qval_signif = ifelse(orpha_qval < 0.05, "significant", "not significant")
         ) 

# add onset groups
gene_network_prop_df = gene_network_prop_df %>%
  mutate(onset_group = factor(earliest_onset,levels = c(), labels = c("Early", "Early","Early", "Childhood", "Childhood", "Later", NA, "Later")))
```

# reproduce the plot

```{r}
# whether the gene is an essential gene
core_module = core_module %>%
  mutate(essential = gene %in% essential_genes_sym,
         essential_pval= phyper(essential_neighbour-1, essential_genes_in_graph, vcount(g_core_module$`5`)-essential_genes_in_graph, deg,lower.tail= FALSE),
         essential_pval_level = cut(essential_pval, breaks = c(1, 0.05,0.01, 0.001,0.0001, 0), labels = rev(c("ns", "*", "**", "***", "****")) ,include.lowest = T),
         essential_pval_signif = ifelse(essential_pval < 0.05, "significant", "not significant"))



# core modules essential genes
ggplot(core_module %>% mutate(essential = factor(essential, levels = c(T,F), labels = c("essential disease genes", "non-essential disease genes"))),
       aes(x = onset, y = deg)) + scale_y_log10() + ylab("network degree") +
  geom_boxplot()  + facet_wrap(. ~ essential)+ stat_compare_means(comparisons = my_comparisons, method = "wilcox") + ggtitle("Essentiality and onset")
```


# Onset by disease groups

```{r}
## orpha_by_earliest_onst


disease_with_enough_counts = orpha_by_earliest_onset_df %>% count(orphaGroupName) %>% dplyr::filter(n>5) %>% pull(orphaGroupName)

disease_earlyonset_prop = orpha_by_earliest_onset_df %>% group_by(orphaGroupName) %>% summarise(earlyprop = sum(earliest_onset %in% c("infancy", "neonatal", "antenatal"))/n()) 

disease_orders = disease_earlyonset_prop %>% arrange(earlyprop) %>% pull(orphaGroupName)


dat = orpha_by_earliest_onset_df %>% 
  count(earliest_onset, orphaGroupName) %>% 
  dplyr::filter(orphaGroupName %in% disease_with_enough_counts) %>% 
  mutate(orphaGroupName = factor(orphaGroupName, levels = disease_orders))

ggplot( dat
         , aes(x = orphaGroupName, y = n, fill = earliest_onset)) + geom_col(position="fill") + #scale_y_continuous(labels=scales::percent) +
  ggtitle("Proportion of earliest onset by disease groups") + coord_flip()
```

## Link to the number of affected tissues

```{r}
# from the heatmap analysis

ntissue_per_disease_count = ntissue_per_disease %>% group_by(name) %>% 
  dplyr::filter(LCC.signif %in% c( "***","****"))  %>% 
                  summarise(tissuecount = sum(n))

dat = inner_join(disease_earlyonset_prop, ntissue_per_disease_count, by = c("orphaGroupName" = "name")) %>% dplyr::filter(orphaGroupName %in% disease_with_enough_counts)

ggplot(dat, aes(x = earlyprop, y = tissuecount, label = orphaGroupName)) + geom_point()  + geom_text_repel()
```


## onset and essentiality


```{r}
dat = gene_network_prop_df %>% dplyr::filter(!is.na(earliest_onset), #take only those with onset
                                             earliest_onset != "all_ages", # remove all ages (unclear)
                                             orphagene # take only disease genes
                                             ) %>% distinct(gene, earliest_onset, essential, orphagene) %>% count(earliest_onset, essential, orphagene)


ggplot(dat, aes(x = essential, y = n, fill = earliest_onset)) + geom_col(position="fill") + scale_y_continuous(labels=scales::percent) +
  ggtitle("Do  essential disease genes cause earlier phenotypes?")
```


## Do genes with earlier phenotypes affect more systems?

```{r}
library(ggrepel)
is_outlier <- function(x) {
  return(x < quantile(x, 0.25) - 1.5 * IQR(x) | x > quantile(x, 0.75) + 1.5 * IQR(x))
}

dat = gene_network_prop_df %>% ungroup %>% dplyr::filter(!is.na(earliest_onset), #take only those with onset
                                             earliest_onset != "all_ages", # remove all ages (unclear)
                                             orphagene # take only disease genes
                                             ) %>% distinct(gene, earliest_onset, essential, orphagene, n_group, onset_group) %>%
  group_by(onset_group) %>%
  mutate(outlier = is_outlier(n_group),
         label = ifelse(outlier, gene, ""))
  
  
  #%>% count(earliest_onset, essential, orphagene, n_group)

my_comparisons = combn(c("Early", "Childhood", "Later"), 2, simplify = F) 

ggplot(dat, aes(x = onset_group, y = n_group)) + geom_boxplot() +
  ggtitle("Do genes affecting multiple systems also exhibit earlier phenotypes?") + 
  geom_text_repel(aes(label = label), na.rm = TRUE, hjust = -0.3) +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox", label = "p.signif")
```

## add the essentiality components

```{r}

my_comparisons = combn(c("Early", "Childhood", "Later"), 2) 

ggplot(dat, aes(x = onset_group, y = n_group)) + geom_boxplot() +
  ggtitle("Do genes affecting multiple systems also exhibit earlier phenotypes?") + 
  geom_text_repel(aes(label = label), na.rm = TRUE, hjust = -0.3) +
  facet_wrap(. ~ essential) #+
  #stat_compare_means(comparisons = my_comparisons, method = "wilcox", label = "p.signif")
```

## Disease genes have higher degrees? compared to non disease genes in PPI?

```{r}
dat = gene_network_prop_df %>% dplyr::filter(network == "ppi")
ggplot(dat, aes(x = -log10(essential_qval), y = degree, col = orphagene)) + geom_point()  + scale_y_log10()
```


## Network effect:

## Do disease genes connect to other disease genes?
```{r}
dat = gene_network_prop_df %>% dplyr::filter(network == "ppi", orphagene, !is.na(earliest_onset), earliest_onset != "all_ages")
ggplot(dat, aes(x = onset_group, y = degree, col = essential)) + geom_boxplot()  + scale_y_log10() + facet_wrap(. ~ essential) +
ggtitle(label = "Is age of onset indicative of network connectivity (PPI)")
```



## perform similar analysis but for all networks
```{r}
dat = gene_network_prop_df %>% 
  dplyr::filter(network%in% c("ppi", "coex_coremodule", "HP"), orphagene, !is.na(earliest_onset), earliest_onset != "all_ages") %>%
  group_by(network) %>%
  summarise(p_value = wilcox.test(DataControl$Value, Value, exact = FALSE)$p.value)


# test wilcoxon: for all genes
wilcox_pval = list()
for(i in unique(gene_network_prop_df$network)){
  dat = gene_network_prop_df %>% dplyr::filter(network == i, orphagene, !is.na(earliest_onset), earliest_onset != "all_ages")
  wilcox_pval[[i]] = pairwise.wilcox.test(dat$degree, dat$onset_group, p.adjust.method="none", paired = F, exact = F) %>% broom::tidy()
}


wilcox_pval_df = bind_rows(wilcox_pval, .id = "network")

# test wilcoxon: for essential genes
wilcox_pval_essential = list()
for(i in unique(gene_network_prop_df$network)){
  dat = gene_network_prop_df %>% dplyr::filter(network == i, orphagene, !is.na(earliest_onset), earliest_onset != "all_ages", essential)
  wilcox_pval_essential[[i]] = pairwise.wilcox.test(dat$degree, dat$onset_group, p.adjust.method="none", paired = F, exact = F) %>% broom::tidy()
}


wilcox_pval_essential_df = bind_rows(wilcox_pval, .id = "network")
```

## plot

```{r}
dat = gene_network_prop_df %>% dplyr::filter(network %in% c("MP", "HP", "ppi"), orphagene, !is.na(earliest_onset), earliest_onset != "all_ages", essential)
my_comparisons = combn(c("Early", "Childhood", "Later"), 2, simplify = F) 

ggplot(dat, aes(x = onset_group, y = degree)) + geom_boxplot()   + facet_wrap(. ~ network) +
ggtitle(label = "Is age of onset indicative of network connectivity") + geom_jitter(fill = "grey") +
  stat_compare_means(comparisons = my_comparisons, method = "wilcox", paired = F)
```

## Differential enrichments of early/late onset genes

It makes sense that early onset genes are sharing phenotypic similarity than late onset genes. As they may cause substantially severe/multi-systems phenotypes -> thus it shows wider range of phenotypes compared to late onset genes.

On the other hand, essential disease genes for later onset are more well-connected than those in earlier onset? why? 
- are they connected to each other (like clustered modules, or they're star-like hubs?)
- are they from a few disease groups? -> that cannot really represent anything about diseases?

```{r}

network_embeded = list()
for(i in c("MP", "HP", "ppi")){
  network_embeded[[i]] = read_tsv(sprintf("../analysis/network_characterisation/embeddings/embedded_results_2D/_%s_tsne.tsv", i), col_types = 'ddc')
  }

network_embeded_df = bind_rows(network_embeded, .id = "network")

network_embeded_df = left_join(network_embeded_df, gene_by_earliest_onset_df, by = c("name" = "gene"))
network_embeded_df =  network_embeded_df %>%
  mutate(onset_group = factor(earliest_onset, labels = c("Early", "Early","Early", "Childhood", "Childhood", "Later", NA, "Later")))

network_embeded_df =  left_join(network_embeded_df, degree_df, by = c("network", "name" = "gene"))

plot_by_onset =  list()

for(i in c("MP", "HP", "ppi")){
plot_by_onset[[i]]  = ggplot(network_embeded_df %>% dplyr::filter(network == i))  + 
      stat_density_2d(aes(X,Y,  fill = stat(level)), geom = "polygon") + 
      theme(panel.background = element_rect(fill = '#0f2030'),
            axis.line=element_blank(),axis.text.x=element_blank(),
            axis.text.y=element_blank(),axis.ticks=element_blank(),
            axis.title.x=element_blank(),
            axis.title.y=element_blank(),legend.position="none",
            panel.border=element_blank(),panel.grid.major=element_blank(),
            panel.grid.minor=element_blank(),plot.background=element_blank())+ 
      geom_point(aes(X,Y, col = onset_group, size = log10(degree))) +
       guides(fill = FALSE, alpha = FALSE, col = FALSE)
}

plot_by_onset$MP + plot_by_onset$HP + (plot_by_onset$ppi)
```

### Transitivity vs degree 

```{r}
transitivity_gene_prop = lapply(g, function(x) tibble(node = V(x)$name, transitivity = transitivity(x, type = "localundirected")))
transitivity_gene_prop_df = bind_rows(transitivity_gene_prop, .id = "network")

head(transitivity_gene_prop_df)
```

# plot the transitivity ande degree
```{r}

dat = gene_network_prop_df %>% dplyr::filter(network %in% c("MP", "HP", "ppi"))
dat = left_join(dat, transitivity_gene_prop_df, by = c("network", "gene" = "node"))
```


```{r}
ggplot(dat %>% dplyr::filter(!is.na(onset_group)),
       aes(x = cut(transitivity, breaks = seq(0, 1, 1/4), include.lowest = T), y= degree, col = onset_group)) + geom_boxplot() + facet_wrap(.~network) + scale_y_log10()
```

```{r}
ggplot(dat %>% dplyr::filter(!is.na(onset_group)),
       aes(x = orpha_qval_level, y= degree, col = onset_group)) + geom_boxplot() + facet_wrap(.~network) + scale_y_log10()
```


# What kind of rare diseases are happening at late onset anyway?
```{r}
dat = gene_network_prop_df %>% 
  ungroup %>% 
  dplyr::filter(!is.na(earliest_onset), #take only those with onset]
                earliest_onset != "all_ages", # remove all ages (unclear)
                orphagene # take only disease genes
               ) %>% 
  mutate(n_group_binned = cut(n_group, breaks = c(0,2,5,10,20))) %>%
  distinct(gene, earliest_onset, essential, orphagene, n_group_binned, onset_group) %>%
  count(onset_group, n_group_binned) 



ggplot(dat, aes(x = onset_group, y = n_group_binned)) + geom_point(aes(size = n)) +
  ggtitle("Do genes affecting multiple systems also exhibit earlier phenotypes?") 

```


# Onset and the number of tissues - binning


```{r}
dat = gene_network_prop_df %>% dplyr::filter(network == "ppi")
ggplot(dat, aes(x = -log10(essential_qval), y = -log10(orpha_qval), col = orphagene)) + geom_point() 
```

```{r}
dat = gene_network_prop_df %>% dplyr::filter(network == "ppi")
ggplot(dat, aes(x = degree, y = degree_essential/degree, col = orphagene)) + geom_point() 
```
## Do disease genes connect to other essential genes?

## Do essential genes connect to other essential genes?

## Do essential disease genes have different connectivity patterns compared to non-essential disease genes?

## Are disease genes affecting more systems essential? Or tend to connect to essential genes?

```{r}
dat = gene_network_prop_df %>% dplyr::filter(network == "coex_coremodule", orphagene)
my_comparisons = combn(c("significant", "not significant"), 2, simplify = F) 
ggplot(dat, aes(x = essential_qval_signif, y = n_group, col = essential)) + geom_boxplot() + facet_wrap(. ~ essential) +
  ggtitle(label = "",subtitle = "Do essential rare disease genes associated to multiple disease groups also tend to connect with other essential genes?") + stat_compare_means(comparisons = my_comparisons, method = "wilcox", label = "p.signif")
```



